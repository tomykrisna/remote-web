(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9321],{39321:(I,x,o)=>{o.r(x),o.d(x,{AnalysisModule:()=>z});var f=o(20482),g=o(1919),_=o(15861),c=o(87911),r=o(90368),v=o(43304),p=o(20553),t=o(22874),A=o(50192),P=o(30658),O=o(18630),w=o(59875),u=o(11929),b=o(62934),C=o(24260);function T(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"span",23),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"date"),t.\u0275\u0275elementEnd()),2&n){const i=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(2,1,i.latestTransactionDate,"DD MMM YYYY, HH:mm")," ")}}function k(n,s){1&n&&(t.\u0275\u0275elementStart(0,"span",23),t.\u0275\u0275text(1," - "),t.\u0275\u0275elementEnd())}function B(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"div",24),t.\u0275\u0275element(1,"lib-analysis-product-card",25),t.\u0275\u0275elementEnd()),2&n){const i=s.$implicit,e=s.index;t.\u0275\u0275advance(1),t.\u0275\u0275property("index",e)("productImage",i.productImage)("productName",i.productName)("productType",i.categoryName)("productPrice",i.price)("productSell",i.quantity)("totalRevenue",i.subtotal)}}function L(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"div",18)(1,"div",19)(2,"span",20),t.\u0275\u0275text(3,"Update Terakhir "),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(4,T,3,4,"span",21)(5,k,2,0,"span",21),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(6,B,2,7,"div",22),t.\u0275\u0275elementEnd()),2&n){const i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(4),t.\u0275\u0275property("ngIf",i.latestTransactionDate),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.latestTransactionDate),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngForOf",i.productAnalytics)}}function j(n,s){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"lib-basic-button",28),t.\u0275\u0275listener("handleEmit",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(a.handleLoadMoreDate())}),t.\u0275\u0275elementEnd()}2&n&&t.\u0275\u0275property("title","Muat Lebih Banyak")("width","!w-full")}function R(n,s){if(1&n&&(t.\u0275\u0275elementStart(0,"div",26),t.\u0275\u0275template(1,j,1,2,"lib-basic-button",27),t.\u0275\u0275elementEnd()),2&n){const i=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.loadMore&&!i.loading)}}function Y(n,s){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"lib-basic-empty-state",29),t.\u0275\u0275listener("clickButton",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.goToPOS())}),t.\u0275\u0275elementEnd()}2&n&&t.\u0275\u0275property("showButton",!0)("buttonLabel","Buka Youtap POS")}function U(n,s){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"lib-basic-empty-state",30),t.\u0275\u0275listener("clickButton",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(a.verifyAccount())}),t.\u0275\u0275elementEnd()}2&n&&t.\u0275\u0275property("showButton",!0)("buttonLabel","Verifikasi Akun")}function V(n,s){1&n&&(t.\u0275\u0275elementStart(0,"div",31),t.\u0275\u0275element(1,"p-skeleton",32)(2,"p-skeleton",32)(3,"p-skeleton",32),t.\u0275\u0275elementEnd())}function N(n,s){if(1&n){const i=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div"),t.\u0275\u0275element(1,"div",2),t.\u0275\u0275elementStart(2,"div",3)(3,"div",4)(4,"div",5)(5,"ion-input",6),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.showDateTimeModal())}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(6,"div",7),t.\u0275\u0275element(7,"img",8),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(8,"div",9)(9,"img",10),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.filterSort())}),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(10,"img",11),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(i);const a=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(a.showModalDowload())}),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(11,"div",12),t.\u0275\u0275template(12,L,7,3,"div",13),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(13,R,2,1,"div",14),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(14,Y,1,2,"lib-basic-empty-state",15)(15,U,1,2,"lib-basic-empty-state",16)(16,V,4,0,"div",17),t.\u0275\u0275elementEnd()}if(2&n){const i=t.\u0275\u0275nextContext();t.\u0275\u0275advance(5),t.\u0275\u0275propertyInterpolate("value",i.combinedDates),t.\u0275\u0275advance(4),t.\u0275\u0275property("title","quantity"===i.filter?"Termurah":"Termahal"),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",i.productAnalytics.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.loadMore&&i.listProductAnalytics.listProductAnalytics.data.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.loading&&i.isVerified&&!i.productAnalytics.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.loading&&!i.isVerified&&!i.productAnalytics.length),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.loading)}}let F=(()=>{var n;class s{constructor(e,a,l,m,d,h,y,D,E,M){var S;this.activatedRoute=e,this.router=a,this.transactionService=l,this.windowActionService=m,this.modalService=d,this.authData=h,this.http=y,this.dowloadFileService=D,this.alertController=E,this.trackerService=M,this.start="",this.loading=!1,this.loadingDownload=!1,this.filter="QUANTITY",this.productAnalytics=[],this.page=1,this.startDate=v().format("YYYY-MM-DD"),this.endDate=v().format("YYYY-MM-DD"),this.minDate=v().subtract(1,"month").toDate(),this.maxDate=new Date,this.loadMore=!1,this.dateRange=[new Date,new Date],this.isShowModal=!1,this.showDownloadReport=!1,this.isProductListNull="",this.start=(null===(S=this.activatedRoute.snapshot)||void 0===S?void 0:S.queryParamMap.get("start"))||""}ngOnInit(){this.start&&(this.startDate=this.start),this.getDetailProfile(),this.getListProductAnalytics(),this.getTransactionUpdatedAt()}getDetailProfile(){this.authData.user&&(this.isVerified=this.authData.user.isVerified)}handleLoadMoreDate(){this.loading=!1,this.page=this.page+1,this.getListProductAnalytics()}getListProductAnalytics(){this.loading=!0,this.loadMore=!0,this.transactionService.listProductAnalytics({page:this.page,perPage:10,orderBy:"QUANTITY"===this.filter?r.KpW.QUANTITY:r.KpW.PRICE,startDate:this.startDate,endDate:this.endDate,merchantId:""}).subscribe({next:({data:a})=>{this.loading=!1,this.listProductAnalytics=a,a.listProductAnalytics.data.forEach(l=>{this.productAnalytics.push(l)}),this.page===a.listProductAnalytics.totalPage&&(this.loadMore=!1)},error:()=>{this.loading=!1}})}downloadProductAnalysisByDate(e){var a=this;return(0,_.Z)(function*(){const l=p.environment.BOS_API_URL+"/product-analytics/generate-report";a.loadingDownload=!0;const m=(new Date).getSeconds();let d=new c.HttpParams;d=d.set("startDate",a.startDate),d=d.set("endDate",a.endDate),d=d.set("fileType",e),d=d.set("orderBy","QUANTITY"===a.filter?"quantity":"price");try{const h=new c.HttpHeaders({Authorization:`Bearer ${a.authData.token}`});a.http.get(l,{headers:h,params:d,responseType:"blob"}).subscribe(y=>{a.loadingDownload=!1,("csv"===e||"excel"===e)&&a.dowloadFileService.jsonToCsv(y,`Laporan-Analisis-Produk${a.startDate}-${a.endDate}-${m}-${e}`)})}catch(h){a.loadingDownload=!1,yield(yield a.alertController.create({header:`Gagal download file: ${h}`,buttons:["Tutup"]})).present()}})()}downloadFileProductAnalysis(e,a){var l=this;return(0,_.Z)(function*(){const m=p.environment.BOS_API_URL+"/product-analytics/generate-report";l.loadingDownload=!0;const d=(new Date).getSeconds();let h=new c.HttpParams;var y;a&&(h=h.set("month",null!==(y=a.indexMonth)&&void 0!==y?y:"0")),e&&(h=h.set("fileType",e));try{const D=new c.HttpHeaders({Authorization:`Bearer ${l.authData.token}`});l.http.get(m,{headers:D,params:h,responseType:"blob"}).subscribe(E=>{("csv"===e||"excel"===e)&&l.dowloadFileService.jsonToCsv(E,`Laporan-Analisis-Produk-bulan-${a.month}-${a.year}-${d}`)})}catch(D){yield(yield l.alertController.create({header:`Gagal download file: ${D}`,buttons:["Tutup"]})).present()}})()}goToPOS(){this.windowActionService.open("https://tabletyoutap.onelink.me/kxXH/ztjkginu","_blank")}verifyAccount(){this.router.navigate(["/register/login-kyc"])}filterSort(){this.modalService.showAnalysisFilter(this.filter).then(e=>{e&&(this.trackerService.logEvent("Analisis_penjualan_sort",e),this.page=1,this.filter=e,this.productAnalytics=[],this.getListProductAnalytics())})}getTransactionUpdatedAt(){this.transactionService.transactionUpdatedAt().subscribe({next:({data:e})=>{e.transactionUpdatedAt.date&&(this.latestTransactionDate=e.transactionUpdatedAt.date)},error:()=>{}})}showDateTimeModal(){this.modalService.showDateTimePicker().then(e=>{e&&(this.trackerService.logEvent("Analisis_penjualan_filter_date"),this.dateTimeValue=e,this.page=1,this.productAnalytics=[],this.startDate=v(this.dateTimeValue[0]).format("YYYY-MM-DD"),this.endDate=v(this.dateTimeValue[1]).format("YYYY-MM-DD"),this.combinedDates=`${this.formatDate(this.startDate)}-${this.formatDate(this.endDate)}`,this.getListProductAnalytics())})}formatDate(e){const a=new Date(e),l=a.getDate(),m=a.getMonth()+1,d=a.getFullYear();return`${this.padZero(l)}/${this.padZero(m)}/${d}`}padZero(e){return e<10?`0${e}`:`${e}`}showModalDowload(){this.modalService.showAnalysisDownload().then(e=>{"DATE_SELECTED"===e?this.modalService.showAnalysisDowloadDateSelected().then(a=>{this.trackerService.logEvent("Analisis_penjualan_download_date_select",a),"EXCEL"===a?this.downloadProductAnalysisByDate("excel"):"CSV"===a&&this.downloadProductAnalysisByDate("csv")}):"MONTHLY"===e&&this.modalService.showAnalysisDowloadDateMonthly().then(a=>{if(a){let l=a;this.modalService.showAnalysisDowloadDateSelected().then(m=>{this.trackerService.logEvent("Analisis_penjualan_download_monthly",m),"EXCEL"===m?this.downloadFileProductAnalysis("excel",l):"CSV"===m&&this.downloadFileProductAnalysis("csv",l)})}})})}}return(n=s).\u0275fac=function(e){return new(e||n)(t.\u0275\u0275directiveInject(g.ActivatedRoute),t.\u0275\u0275directiveInject(g.Router),t.\u0275\u0275directiveInject(r.pXi),t.\u0275\u0275directiveInject(A.k),t.\u0275\u0275directiveInject(P.Z),t.\u0275\u0275directiveInject(O.x),t.\u0275\u0275directiveInject(c.HttpClient),t.\u0275\u0275directiveInject(w.n),t.\u0275\u0275directiveInject(u.Br),t.\u0275\u0275directiveInject(b.O))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-product-analysis"]],decls:2,vars:1,consts:[["id","list-product-analysis",1,"flex","flex-col","my-[3%]","overflow-y-scroll","scrollbar-hide","h-full","bg-neutral-grey-6","font-effra"],[4,"ngIf"],[1,"spacer","h-[14px]","bg-neutral-grey-6"],[1,"bg-white","pt-3"],[1,"flex","flex-row","p-[10px]"],[1,"w-full","h-[43px]","flex","justify-between","items-center"],["placeholder","Pilih tanggal",1,"full-border-input","font-effra",3,"value","click"],[1,"custom-icon-container"],["src","./assets/images/png/calendar-grey.png","alt","Custom Icon",1,"custom-icon"],[1,"w-[35%]","gap-2","flex","justify-around","items-center"],["src","./assets/images/png/button-filter-2.png","alt","filter-button","width","43px",1,"cursor-pointer","!h-[43px]",3,"title","click"],["src","../../../../assets/images/png/button-download.png","alt","download-button","width","43px",1,"cursor-pointer","!h-[43px]",3,"click"],[1,"flex","flex-col","px-[16px]","py-[8px]","gap-y-3"],["class","flex flex-col gap-y-4",4,"ngIf"],["class","flex flex-col px-[16px] pb-[20px]",4,"ngIf"],["image","./assets/images/png/empty-transaction-subscription.png","label","Wah.. tidak ada transaksi ditanggal ini, yuks pilih tanggal yang lain..","description","Ayo, Lakukan transaksi sekarang dari Youtap POS!",3,"showButton","buttonLabel","clickButton",4,"ngIf"],["image","./assets/images/png/sending-otp.png","label","Kamu belum melakukan verifikasi!","description","Lakukan verifikasi dan buat transaksi melalui Youtap POS sekarang.",3,"showButton","buttonLabel","clickButton",4,"ngIf"],["class","flex flex-col p-[16px] gap-y-3 bg-white",4,"ngIf"],[1,"flex","flex-col","gap-y-4"],[1,"text-[12px]","font-effra"],[1,"text-grey-4"],["class","text-grey-3",4,"ngIf"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"text-grey-3"],[1,"flex","flex-col"],[3,"index","productImage","productName","productType","productPrice","productSell","totalRevenue"],[1,"flex","flex-col","px-[16px]","pb-[20px]"],[3,"title","width","handleEmit",4,"ngIf"],[3,"title","width","handleEmit"],["image","./assets/images/png/empty-transaction-subscription.png","label","Wah.. tidak ada transaksi ditanggal ini, yuks pilih tanggal yang lain..","description","Ayo, Lakukan transaksi sekarang dari Youtap POS!",3,"showButton","buttonLabel","clickButton"],["image","./assets/images/png/sending-otp.png","label","Kamu belum melakukan verifikasi!","description","Lakukan verifikasi dan buat transaksi melalui Youtap POS sekarang.",3,"showButton","buttonLabel","clickButton"],[1,"flex","flex-col","p-[16px]","gap-y-3","bg-white"],["width","100%","height","7rem"]],template:function(e,a){1&e&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275template(1,N,17,7,"div",1),t.\u0275\u0275elementEnd()),2&e&&(t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",a.listProductAnalytics))},dependencies:[f.NgForOf,f.NgIf,r.VQq,r.nM0,r.SWN,C.O,u.pK,u.j9,f.DatePipe],styles:[".full-border-input[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-color:#e0e0e0;font-size:14px;border-radius:8px;padding:0 10px!important;min-height:43px!important}.full-border-input[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{color:#bdbdbd!important;font-weight:400}.custom-icon-container[_ngcontent-%COMP%]{position:relative;right:10%}.custom-icon[_ngcontent-%COMP%]{width:16px;height:auto}"]}),s})();var K=o(6593),W=o(23766);const $=[{path:"",component:(()=>{var n;class s{constructor(e,a){this.title=e,this.route=a,this.titlePage="title"}ngOnInit(){this.setTitle(),this.route.events.subscribe(e=>{e instanceof g.NavigationEnd&&setTimeout(()=>{this.setTitle()},0)})}setTitle(){this.titlePage=this.title.getTitle()}}return(n=s).\u0275fac=function(e){return new(e||n)(t.\u0275\u0275directiveInject(K.Dx),t.\u0275\u0275directiveInject(g.Router))},n.\u0275cmp=t.\u0275\u0275defineComponent({type:n,selectors:[["app-analysis-container"]],decls:5,vars:1,consts:[[1,"analysis-container","h-full","bg-neutral-grey-6"],["id","header",1,"h-[60px]","z-10","sticky","top-0","bg-pr"],[3,"title"],["id","body",1,"overflow-y-scroll","scrollbar-hide","h-[calc(100%-44px)]","mt-[-16px]"]],template:function(e,a){1&e&&(t.\u0275\u0275elementStart(0,"div",0)(1,"div",1),t.\u0275\u0275element(2,"app-basic-header",2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"div",3),t.\u0275\u0275element(4,"router-outlet"),t.\u0275\u0275elementEnd()()),2&e&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("title",a.titlePage))},dependencies:[g.RouterOutlet,W.K]}),s})(),children:[{path:"",component:F,title:"Analisis-Produk",data:{pageTitle:"Analisis Produk"}}]}];let H=(()=>{var n;class s{}return(n=s).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({imports:[g.RouterModule.forChild($),g.RouterModule]}),s})();var Q=o(60095),Z=o(43825);let z=(()=>{var n;class s{}return(n=s).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=t.\u0275\u0275defineInjector({imports:[f.CommonModule,H,r.dTQ,Z.Q,r.hJ1,r.PPX,r.gPf,r.zkK,r.drE,C.m,Q.u5,u.Pc]}),s})()},43825:(I,x,o)=>{o.d(x,{Q:()=>w});var f=o(20482),_=o(90368),c=o(24260),r=o(46800),v=o(30658),p=o(87207),t=o(11929),A=o(26727),P=o(22874);let w=(()=>{var u;class b{}return(u=b).\u0275fac=function(T){return new(T||u)},u.\u0275mod=P.\u0275\u0275defineNgModule({type:u}),u.\u0275inj=P.\u0275\u0275defineInjector({providers:[v.Z],imports:[f.CommonModule,_.FFv,_.dTQ,c.m,_.$QN,r.d,p.m,t.Pc,A.F,_.hJ1]}),b})()},46800:(I,x,o)=>{o.d(x,{d:()=>v});var f=o(20482),_=o(90368),c=o(22874);let v=(()=>{var p;class t{}return(p=t).\u0275fac=function(P){return new(P||p)},p.\u0275mod=c.\u0275\u0275defineNgModule({type:p}),p.\u0275inj=c.\u0275\u0275defineInjector({imports:[f.CommonModule,_.$QN]}),t})()}}]);