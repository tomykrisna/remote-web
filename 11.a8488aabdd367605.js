(self.webpackChunkyoutapBos=self.webpackChunkyoutapBos||[]).push([[11],{37011:(O,m,a)=>{a.r(m),a.d(m,{InboxModule:()=>j});var c=a(54887),d=a(44398),r=a(60654),e=a(17460),x=a(9275),p=a(96608),b=a(56890),h=a(25879),g=a(36480),u=a(9523);function _(n,s){if(1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.shortDescription)}}function f(n,s){if(1&n&&e.\u0275\u0275element(0,"span",13),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("innerHtml",t.content,e.\u0275\u0275sanitizeHtml)}}function I(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",14),e.\u0275\u0275listener("click",function(i){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.setToggleReadMore(i))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.seeMore?"See Less":"Read More"," ")}}function v(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"img",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.setRedirect())}),e.\u0275\u0275elementEnd()}if(2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("src",t.image,e.\u0275\u0275sanitizeUrl)}}let y=(()=>{class n{constructor(t,o,i){this.router=t,this.sanitizer=o,this.gaService=i,this.isRead=!0,this.seeMore=!1,this.readInboxId=new e.EventEmitter}ngOnInit(){switch(this.content=this.sanitizer.bypassSecurityTrustHtml(this.description),this.category){case r.T47.ALL:this.categoryName="Semua";break;case r.T47.CAMPAIGN:this.categoryName="Campaign";break;case r.T47.REMINDER:this.categoryName="Reminder";break;case r.T47.PROMO:this.categoryName="Promo";break;case r.T47.INFO:this.categoryName="Info"}}setToggleReadMore(t){t.stopPropagation(),this.seeMore=!this.seeMore,this.setReadInbox()}setReadInbox(){this.isRead||(this.isRead=!0,this.readInboxId.emit(this.id))}setRedirect(){if(this.gaService.addEvent("inbox detail "+this.broadcastName,"banner",""),this.setReadInbox(),this.link){let t;switch(this.type){case r.Ppq.INTERNAL:t=this.link.split(window.location.protocol+"//"+window.location.host),2===t.length?this.router.navigate([t[1]]).then():window.open(this.link,"_blank");break;case r.Ppq.EXTERNAL:window.open(this.link,"_blank")}}}static#e=this.\u0275fac=function(o){return new(o||n)(e.\u0275\u0275directiveInject(d.Router),e.\u0275\u0275directiveInject(g.H7),e.\u0275\u0275directiveInject(h.O))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["inbox-card"]],inputs:{category:"category",title:"title",description:"description",date:"date",image:"image",isRead:"isRead",shortDescription:"shortDescription",id:"id",type:"type",link:"link",broadcastName:"broadcastName"},outputs:{readInboxId:"readInboxId"},decls:18,vars:14,consts:[[3,"click"],[1,"flex","flex-row","mt-4","border-b-[1px]","border-grey-5","pb-1"],[1,"mr-[10px]"],["src","/assets/images/svg/info-blue.svg","width","24px","height","24px","alt","info-icon",1,""],[1,"flex-row","w-full"],[1,"flex","flex-row","justify-between"],[1,"text-grey-3","text-[12px]"],[1,"text-[14px]","text-xl"],[1,"text-[14px]"],[4,"ngIf"],[3,"innerHtml",4,"ngIf"],["class","text-primary-yt-blue text-[14px] cursor-pointer underline",3,"click",4,"ngIf"],["class","!w-full !h-auto","alt","","alt","inbox-image",3,"src","click",4,"ngIf"],[3,"innerHtml"],[1,"text-primary-yt-blue","text-[14px]","cursor-pointer","underline",3,"click"],["alt","","alt","inbox-image",1,"!w-full","!h-auto",3,"src","click"]],template:function(o,i){1&o&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("click",function(){return i.setReadInbox()}),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2),e.\u0275\u0275element(3,"img",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",4)(5,"div",5)(6,"span",6),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"span",6),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"formatDate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(11,"h3",7),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",8),e.\u0275\u0275template(14,_,2,1,"span",9)(15,f,1,1,"span",10)(16,I,2,1,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(17,v,1,1,"img",12),e.\u0275\u0275elementEnd()()()),2&o&&(e.\u0275\u0275classMapInterpolate1("px-[16px] pt-1 ",i.isRead?"":"bg-blue-100"," cursor-pointer"),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(i.categoryName),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind3(10,10,i.date,"DD MMMM YYYY | HH:mm",!1)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(i.title),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!i.seeMore),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.seeMore),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!i.seeMore),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.image))},dependencies:[c.NgIf,u.i],styles:["ol,ul,menu{list-style-position:inside!important;all:revert}a{color:#1caed4;text-decoration:underline}\n"],encapsulation:2})}return n})();function w(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"inbox-card",20),e.\u0275\u0275listener("readInboxId",function(i){e.\u0275\u0275restoreView(t);const l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.setReadInbox(i))}),e.\u0275\u0275elementEnd()()}if(2&n){const t=s.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("id",t.id)("shortDescription",t.inbox.shortDescription)("description",t.inbox.description)("isRead",t.isRead)("date",t.inbox.createdAt.toString())("title",t.inbox.title)("image",t.inbox.imageUrl)("category",t.inbox.category)("type",t.inbox.eventType)("link",t.inbox.link)("broadcastName",t.inbox.broadcastName)}}function C(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"lib-basic-button",24),e.\u0275\u0275listener("handleEmit",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(i.loadInBox())}),e.\u0275\u0275elementEnd()}2&n&&e.\u0275\u0275property("outlined",!0)("borderColor","blue")}function k(n,s){if(1&n&&(e.\u0275\u0275elementStart(0,"div",21)(1,"div",22),e.\u0275\u0275template(2,C,1,2,"lib-basic-button",23),e.\u0275\u0275elementEnd()()),2&n){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.canLoad)}}function L(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"div",8)(2,"div",9)(3,"h3",10),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.markAllRead())}),e.\u0275\u0275text(4," Tandai semua dibaca "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",11)(6,"div",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.overviewFilter())}),e.\u0275\u0275elementStart(7,"p",13),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"img",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.refreshInbox())}),e.\u0275\u0275element(11,"img",16),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(12,"div")(13,"div",17),e.\u0275\u0275template(14,w,2,11,"div",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(15,k,3,1,"div",19),e.\u0275\u0275elementEnd()()}if(2&n){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1(" ",t.limitString(t.label,7)," "),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.listInbox),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.listInbox.length&&t.canLoad)}}function S(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",25)(1,"lib-basic-empty-state",26),e.\u0275\u0275listener("clickButton",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.refreshInbox())})("clickButtonSecondary",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(i.toBack())}),e.\u0275\u0275elementEnd()()}2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("image","./assets/images/png/inbox-empty-state.png")("label","Belum ada inbox")("description","Nantikan program menarik dari Youtap!")("showButton",!0)("buttonWidth","!w-auto")("buttonLabel","Refresh Inbox")("showButtonSecondary",!0)("buttonLabelSecondary","Kembali ke Halaman Utama"))}function R(n,s){if(1&n&&(e.\u0275\u0275elementStart(0,"div",5),e.\u0275\u0275template(1,L,16,3,"div",6)(2,S,2,8,"div",7),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.listInbox.length>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===t.listInbox.length)}}function E(n,s){1&n&&(e.\u0275\u0275elementStart(0,"div",27),e.\u0275\u0275element(1,"img",28),e.\u0275\u0275elementStart(2,"h6",29),e.\u0275\u0275text(3," Tunggu sebentar yah.. "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",30),e.\u0275\u0275text(5,"kita lagi refresh inboxnya.."),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"img",31),e.\u0275\u0275elementEnd())}function T(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32)(1,"span"),e.\u0275\u0275text(2,"Filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"i",33),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const i=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(i.isShowFilter=!i.isShowFilter)}),e.\u0275\u0275elementEnd()()}}function V(n,s){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"lib-basic-button",36),e.\u0275\u0275listener("handleEmit",function(){const l=e.\u0275\u0275restoreView(t).$implicit,U=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(U.setRange(l.type))}),e.\u0275\u0275elementEnd()}if(2&n){const t=s.$implicit,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("title",t.name)("borderColor","blue")("width","w-full")("textColor",t.type===o.selectedRange?"text-white":"text-primary-yt-blue")("outlined",t.type!==o.selectedRange)}}function M(n,s){if(1&n&&(e.\u0275\u0275elementStart(0,"div",34),e.\u0275\u0275template(1,V,1,5,"lib-basic-button",35),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.listRange)}}let N=(()=>{class n{constructor(t,o){this.inboxService=t,this.location=o,this.listInbox=[],this.listRange=[{name:"Semua Notifikasi",type:r.xPx.ALL},{name:"14 hari Terakhir",type:r.xPx.DAY_14},{name:"7 hari Terakhir",type:r.xPx.DAY_7}],this.totalPage=10,this.page=1,this.limit=10,this.isShowFilter=!1,this.label="Filter",this.selectedRange=r.xPx.ALL,this.isLoading=!0,this.canLoad=!1,this.checkData=0}ngOnInit(){this.isLoading=!0,this.getListInbox(),this.autoRefreshInbox()}refreshInbox(){this.listInbox=[],this.isLoading=!0,this.getListInbox()}autoRefreshInbox(){this.checkData=setInterval(t=>{this.getListInbox(),clearInterval(t)},5e3)}fetchData(){this.page=1,this.listInbox=[],this.isLoading=!0,this.getListInbox()}overviewFilter(){this.isShowFilter=!this.isShowFilter}setRange(t){this.page=1,this.selectedRange!==t&&(this.label=this.convertRangeLabel(t),this.selectedRange=t,this.isShowFilter=!1,this.fetchData())}convertRangeLabel(t){switch(t){case r.xPx.ALL:return"Semua Notifikasi";case r.xPx.DAY_14:return"14 Hari Terakhir";case r.xPx.DAY_7:return"7 Hari Terakhir";default:return"Filter"}}limitString(t,o){return t.length>o?t.substring(0,o)+"...":t}getListInbox(){this.canLoad=!0;const t={page:this.page,limit:this.limit,filter:{}};this.selectedRange!==r.xPx.ALL&&(t.filter={interval:this.selectedRange}),this.inboxService.listUserInbox({listUserInboxInput:t}).subscribe({next:({data:o})=>{this.totalPage=o.listUserInbox.totalPage||0;const i=new Set(this.listInbox.map(l=>l.id));this.listInbox=this.listInbox.concat(o.listUserInbox.userInboxes.filter(l=>!i.has(l.id))),this.isLoading=!1,this.page===o.listUserInbox.totalPage&&(this.canLoad=!1)},error:()=>{this.isLoading=!1}})}setReadInbox(t){this.inboxService.readUnreadUserInbox({readUnreadUserInboxInput:{isRead:!0,ids:[t]}}).subscribe({next:()=>{}})}markAllRead(){this.inboxService.readUnreadAllInbox({readUnreadAllUserInboxInput:{isRead:!0}}).subscribe({next:t=>{t&&this.fetchData()}})}loadInBox(){this.page=this.page+1,this.canLoad&&this.getListInbox()}toBack(){this.location.back()}ngOnDestroy(){clearInterval(this.checkData)}static#e=this.\u0275fac=function(o){return new(o||n)(e.\u0275\u0275directiveInject(r.mzz),e.\u0275\u0275directiveInject(c.Location))};static#t=this.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["list-inbox"]],decls:7,vars:3,consts:[["class","mt-[3%] h-[99%] overflow-y-scroll scrollbar-hide bg-grey-6",4,"ngIf"],["class","flex flex-col items-center mt-4",4,"ngIf"],[3,"showModal"],["headerTemplate",""],["bodyTemplate",""],[1,"mt-[3%]","h-[99%]","overflow-y-scroll","scrollbar-hide","bg-grey-6"],[4,"ngIf"],["class","bg-white text-center py-5 mt-4",4,"ngIf"],[1,"flex","flex-col","p-[16px]","gap-2","sticky","top-0","bg-white"],[1,"flex","flex-row","justify-between","gap-x-2"],[1,"my-auto","text-[12px]","text-primary-yt-blue","cursor-pointer",3,"click"],[1,"flex","flex-row","gap-x-2"],[1,"rounded-lg","border-2","px-2","py-1","flex","h-8","items-center","border-blue",3,"click"],[1,"mr-2","pt-1","text-sm","text-blue"],["src","./assets/images/svg/arrow-down.svg",1,"w-5"],[1,"mt-1",3,"click"],["src","./assets/images/svg/reload.svg","alt",""],[1,"pb-[16px]","rounded-b-[20px]","bg-white"],[4,"ngFor","ngForOf"],["class","py-[3%] bg-grey-6",4,"ngIf"],[3,"id","shortDescription","description","isRead","date","title","image","category","type","link","broadcastName","readInboxId"],[1,"py-[3%]","bg-grey-6"],[1,"bg-white","p-[16px]"],["title","Lihat Lebih Banyak","width","w-full",3,"outlined","borderColor","handleEmit",4,"ngIf"],["title","Lihat Lebih Banyak","width","w-full",3,"outlined","borderColor","handleEmit"],[1,"bg-white","text-center","py-5","mt-4"],[3,"image","label","description","showButton","buttonWidth","buttonLabel","showButtonSecondary","buttonLabelSecondary","clickButton","clickButtonSecondary"],[1,"flex","flex-col","items-center","mt-4"],["src","./assets/images/png/kasir-digital.png","width","200px","alt","kasir-digital"],[1,"text-[16px]","text-grey-1","font-medium","mt-2","text-center"],[1,"text-[10px]","text-grey-3","text-center","mb-5"],["src","./assets/images/svg/loading.svg",1,"pb-5"],[1,"flex","flex-row","justify-between","items-center","z-10","relative","h-[5vh]"],[1,"pi","pi-times",3,"click"],[1,"flex","flex-col","gap-y-2","mt-3","max-h-[50vh]","overflow-y-scroll","scrollbar-hide"],[3,"title","borderColor","width","textColor","outlined","handleEmit",4,"ngFor","ngForOf"],[3,"title","borderColor","width","textColor","outlined","handleEmit"]],template:function(o,i){1&o&&(e.\u0275\u0275template(0,R,3,2,"div",0)(1,E,7,0,"div",1),e.\u0275\u0275elementStart(2,"lib-bottom-modal",2),e.\u0275\u0275template(3,T,4,0,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)(5,M,2,1,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275property("ngIf",!i.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",i.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275property("showModal",i.isShowFilter))},dependencies:[c.NgForOf,c.NgIf,x.n,p.S,b.S,y],encapsulation:2})}return n})();const B=[{path:"",component:a(78963).o,data:{canGoBack:!0},children:[{path:"",component:N,title:"Inbox"}]}];let D=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[d.RouterModule.forChild(B),d.RouterModule]})}return n})();var P=a(71093),A=a(24921);let j=(()=>{class n{static#e=this.\u0275fac=function(o){return new(o||n)};static#t=this.\u0275mod=e.\u0275\u0275defineNgModule({type:n});static#n=this.\u0275inj=e.\u0275\u0275defineInjector({imports:[c.CommonModule,D,r.drE,P.Rq,r.hJ1,r.zkK,A.m,r.PPX]})}return n})()}}]);
//# sourceMappingURL=11.a8488aabdd367605.js.map